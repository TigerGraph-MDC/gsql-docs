= Define the Schema

We will use the http://ldbcouncil.org/developer/snb[LDBC Social Network Benchmark] (LDBC SNB) data set.
This data set models a typical online forum where users post messages and discuss topics. It comes with a data generator, which allows you to generate data at different scale factors.
Scale factor 1 generates roughly 1GB of raw data, scale factor 10 generates roughly 10GB of raw data, and so on.

image::screen-shot-2019-05-15-at-5.05.00-pm.png[Figure 1. LDBC SNB Schema]

Figure 1 shows the schema (from the http://ldbc.github.io/ldbc_snb_docs/ldbc-snb-specification.pdf[LDBC SNB specification]).
It models the activities and relationships of social forum participants.
For example, a forum Member can publish Posts on a Forum, and other Members of the Forum can make a Comment on the Post or on someone else's Comment.

A Person's home location is a hierarchy (Continent>Country>City), and a person can be affiliated with a University or a Company.
A Tag can be used to classify a Forum, a Message, or a Person's interests. Tags can further be classified by TagClass.
The relationships between entities are modeled as directed edges, except Person KNOWS Person is modeled as an undirected edge.
For example, Person connects to Tag by the hasInterest edge. Forum connects to Person by two different edges, hasMember and hasModerator.




== Schema naming conventions

The naming conventions for the LDBC schema follow the xref:appendix:gsql-style-guide.adoc[GSQL style guide].


=== Vertex type

For each entity in Figure 1 (the rectangular boxes), we create a vertex type with first letter capitalized and words are separated by an underscore.

* `Person` is a person who participates in a forum.
* `Forum` is a place where persons discuss topics.
* `City`, `Country`, and `Continent` are geographic locations of other entities.
* `Company` and `University` are organizations with which a person can be affiliated.
* `Comment` and `Post` are the interaction messages created by persons in a forum.
* `Tag` is a topic or a concept.
* `Tag_Class` is a class or a category.
`Tag_Class` can form a hierarchy of tags.



=== Edge type

For each relationship type,  we create an edge type with the relationship name *(first letter capitalized and words are separated by an underscore).*
For example,

* `Container_Of`: Forum is the container of posts.
* `Has_Interests`: Person has interest in tag(s).
* `Is_Subclass_Of`: Tag is a subclass of another Tag.

When multiple relationships share the same semantics in Figure 1, we merge them into a single compound edge type. For example:

* `Is_Located_In`: Comment or Post is located in Country, Company is located in Country, Person is located in City, and University is located in City.


== GSQL Schema DDL

Two GSQL scripts for defining the LDBC-SNB schema are shown below. Choose the one that serve your needs. They are not equivalent if you have different organizations using the same graph database instance.


In this method, global vertex/edge type containers are created first. Next, graphs are created to group them.
In other words, the global vertex/edge type containers can be shared across graphs.

.LDBC-SNB schema
[source,gsql]
----
// Clear the current catalog.
// It may take a while since it restarts the subsystem services.
DROP ALL

//create vertex types

include::appendix:example$ldbc_snb/ldbc_snb_schema_creation.gsql[]
----




